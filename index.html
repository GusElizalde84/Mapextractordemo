<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Recomendaciones de Aaron</title>
<link href="https://fonts.googleapis.com/css2?family=Roboto:wght@400;500;700&display=swap" rel="stylesheet">
<script src="https://cdn.jsdelivr.net/npm/html2pdf.js@0.10.1/dist/html2pdf.bundle.min.js"></script>
<script src="https://cdn.tailwindcss.com"></script>
</head>
<body class="bg-gray-50 font-['Roboto'] text-gray-800">
<header class="bg-blue-600 text-white p-4 flex justify-between items-center shadow">
  <div class="flex items-center gap-3">
    <img src="logo.png" alt="logo" class="w-10 h-10 object-contain">
    <h1 class="text-xl font-bold">Recomendaciones de Aaron</h1>
  </div>
  <button id="menuBtn" class="md:hidden p-2 rounded hover:bg-blue-700">☰</button>
  <nav id="menu" class="hidden md:flex gap-4">
    <a href="#" class="hover:underline">Inicio</a>
    <a href="#" id="helpBtn" class="hover:underline">Ayuda</a>
  </nav>
</header>

<main class="max-w-5xl mx-auto p-4 mt-6">
  <div class="flex flex-col md:flex-row gap-3 mb-4 items-center justify-center">
    <select id="citySelect" class="border rounded p-2">
      <option value="CDMX">Ciudad de México</option>
      <option value="Guadalajara">Guadalajara</option>
      <option value="Monterrey">Monterrey</option>
    </select>
    <input id="searchInput" type="text" placeholder="Buscar restaurante..." class="border p-2 rounded w-full md:w-1/2">
    <button id="searchBtn" class="bg-blue-600 text-white px-4 py-2 rounded hover:bg-blue-700">Buscar</button>
  </div>

  <div id="loading" class="hidden text-center text-gray-500">🔄 Buscando restaurantes...</div>
  <div id="results" class="mt-6 overflow-x-auto hidden">
    <table class="w-full border text-sm bg-white shadow rounded">
      <thead class="bg-gray-100">
        <tr>
          <th class="border p-2 text-left">Nombre</th>
          <th class="border p-2 text-center">⭐ Calificación</th>
          <th class="border p-2 text-center">💬 Reseñas</th>
          <th class="border p-2 text-left">📍 Dirección</th>
        </tr>
      </thead>
      <tbody id="resultsBody"></tbody>
    </table>
    <div class="text-center mt-4">
      <button id="pdfBtn" class="bg-green-600 text-white px-4 py-2 rounded hover:bg-green-700">📄 Exportar a PDF</button>
    </div>
  </div>
</main>

<!-- Modal Ayuda -->
<div id="helpModal" class="hidden fixed inset-0 bg-black bg-opacity-40 flex items-center justify-center">
  <div class="bg-white rounded-lg p-6 max-w-md text-center shadow-lg">
    <h2 class="text-xl font-semibold mb-2">Ayuda</h2>
    <p class="text-sm mb-4">Ingresa el nombre del restaurante o tipo de comida, selecciona la ciudad y haz clic en <b>Buscar</b>.<br>Puedes usar <b>Exportar a PDF</b> para guardar un reporte con los resultados.</p>
    <button id="closeHelp" class="bg-blue-600 text-white px-4 py-2 rounded hover:bg-blue-700">Cerrar</button>
  </div>
</div>

<script>
const searchBtn = document.getElementById('searchBtn');
const loading = document.getElementById('loading');
const results = document.getElementById('results');
const resultsBody = document.getElementById('resultsBody');
const pdfBtn = document.getElementById('pdfBtn');

searchBtn.addEventListener('click', async () => {
  const query = document.getElementById('searchInput').value.trim();
  if (!query) return alert('Ingresa un término de búsqueda');
  const city = document.getElementById('citySelect').value;
  loading.classList.remove('hidden');
  results.classList.add('hidden');
  searchBtn.disabled = true;

  setTimeout(() => {
    const data = [
      {nombre: "Taquería Roma", calif: 4.8, reseñas: 120, dir: "Av. Álvaro Obregón 100, Roma Norte, CDMX"},
      {nombre: "El Califa Roma", calif: 4.7, reseñas: 300, dir: "Álvaro Obregón 174, Roma Norte, CDMX"},
      {nombre: "Los Parados", calif: 4.6, reseñas: 250, dir: "Av. Monterrey 333, Roma Sur, CDMX"},
      {nombre: "El Parnita", calif: 4.5, reseñas: 280, dir: "Av. Yucatán 84, Roma Norte, CDMX"}
    ].sort((a,b)=>b.calif - a.calif);
    resultsBody.innerHTML = data.map(r => \`<tr><td class='border p-2'>\${r.nombre}</td><td class='border p-2 text-center'>\${r.calif}</td><td class='border p-2 text-center'>\${r.reseñas}</td><td class='border p-2'>\${r.dir}</td></tr>\`).join('');
    loading.classList.add('hidden');
    results.classList.remove('hidden');
    searchBtn.disabled = false;
  }, 1200);
});

pdfBtn.addEventListener('click', () => {
  const element = document.getElementById('results');
  const opt = {
    margin: 10,
    filename: 'reporte_aaron.pdf',
    image: { type: 'jpeg', quality: 0.98 },
    html2canvas: { scale: 2 },
    jsPDF: { unit: 'mm', format: 'a4', orientation: 'portrait' }
  };
  html2pdf().set(opt).from(element).save();
});

// Modal ayuda
document.getElementById('helpBtn').onclick = () => document.getElementById('helpModal').classList.remove('hidden');
document.getElementById('closeHelp').onclick = () => document.getElementById('helpModal').classList.add('hidden');
</script>
</body>
</html>
